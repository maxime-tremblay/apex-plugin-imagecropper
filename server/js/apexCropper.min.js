var apexCropper={parseBoolean:function(e){var p;switch(e.toLowerCase()){case"true":p=!0;break;case"false":p=!1;break;default:p=void 0}return p},clob2Array:function(e,p,a){loopCount=Math.floor(e.length/p)+1;for(var o=0;o<loopCount;o++)a.push(e.slice(p*o,p*(o+1)));return a},dataURI2base64:function(e){return e.substr(e.indexOf(",")+1)},save2Db:function(e,p,a,o){var r=apexCropper.dataURI2base64(a),t=[];t=apexCropper.clob2Array(r,3e4,t),apex.server.plugin(e,{f01:t},{dataType:"html",success:function(){apex.event.trigger(p,"apexcropper-saved-db",""),o()},error:function(e,a){apex.event.trigger(p,"apexcropper-error-db",""),apex.debug.trace("apexCropper: apex.server.plugin ERROR:",a),o()}})},apexCropperInit:function(){var daThis=this,$image=this.affectedElements,l_options=JSON.parse(daThis.action.attribute01),l_logging=apexCropper.parseBoolean(l_options.logging),l_saveSelector=l_options.saveSelector,l_croppedImageMaxWidth=isNaN(l_options.croppedImageWidth)?void 0:parseInt(l_options.croppedImageWidth),l_croppedImageMaxHeight=isNaN(l_options.croppedImageHeight)?void 0:parseInt(l_options.croppedImageHeight),l_croppedImageWidth,l_croppedImageHeight,l_showSpinner=apexCropper.parseBoolean(l_options.showSpinner),options={viewMode:parseInt(l_options.viewMode),dragMode:l_options.dragMode,aspectRatio:eval(l_options.aspectRatio),preview:l_options.previewSelector,minContainerWidth:parseInt(l_options.minContainerWidth),minContainerHeight:parseInt(l_options.minContainerHeight),minCanvasWidth:parseInt(l_options.minCanvasWidth),minCanvasHeight:parseInt(l_options.minCanvasHeight),minCropBoxWidth:parseInt(l_options.minCropBoxWidth),minCropBoxHeight:parseInt(l_options.minCropBoxHeight)};l_logging&&(apex.debug.trace("apexCropper: Cropper Options :"+options),apex.debug.trace(options),apex.debug.trace("apexCropper: Attribute saveSelector:",l_saveSelector),apex.debug.trace("apexCropper: Attribute croppedImageWidth:",l_croppedImageMaxWidth),apex.debug.trace("apexCropper: Attribute croppedImageHeight:",l_croppedImageMaxHeight),apex.debug.trace("apexCropper: Attribute showSpinner:",l_showSpinner)),$image.cropper(options),$(l_saveSelector).click(function(){var e,p=$image.cropper("getData"),a=p.width,o=p.height;p.width/p.height;if(l_showSpinner)var r=apex.util.showSpinner();l_croppedImageMaxWidth||l_croppedImageMaxHeight?(l_croppedImageMaxWidth&&a>l_croppedImageMaxWidth&&(o*=l_croppedImageMaxWidth/a,a=l_croppedImageMaxWidth),l_croppedImageMaxHeight&&o>l_croppedImageMaxHeight&&(a*=l_croppedImageMaxHeight/o,o=l_croppedImageMaxHeight),e=$image.cropper("getCroppedCanvas",{width:a,height:o})):e=$image.cropper("getCroppedCanvas"),apexCropper.save2Db(l_options.ajaxIdentifier,$image,e.toDataURL(),function(){l_showSpinner&&r.remove()})})}};
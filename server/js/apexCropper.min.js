var apexCropper={parseBoolean:function(e){var p;switch(e.toLowerCase()){case"true":p=!0;break;case"false":p=!1;break;default:p=void 0}return p},clob2Array:function(e,p,o){loopCount=Math.floor(e.length/p)+1;for(var r=0;r<loopCount;r++)o.push(e.slice(p*r,p*(r+1)));return o},dataURI2base64:function(e){return e.substr(e.indexOf(",")+1)},save2Db:function(e,p,o,r){var t=apexCropper.dataURI2base64(o),a=[];a=apexCropper.clob2Array(t,3e4,a),apex.server.plugin(e,{f01:a},{dataType:"html",success:function(){apex.event.trigger(p,"apexcropper-saved-db",""),r()},error:function(e,o){apex.event.trigger(p,"apexcropper-error-db",""),apex.debug.trace("apexCropper: apex.server.plugin ERROR:",o),r()}})},apexCropperInit:function(){var daThis=this,$image=this.affectedElements,l_options=JSON.parse(daThis.action.attribute01),l_logging=apexCropper.parseBoolean(l_options.logging),l_saveSelector=l_options.saveSelector,l_croppedImageWidth=parseInt(l_options.croppedImageWidth),l_croppedImageHeight=parseInt(l_options.croppedImageHeight),l_showSpinner=apexCropper.parseBoolean(l_options.showSpinner),options={viewMode:parseInt(l_options.viewMode),dragMode:l_options.dragMode,aspectRatio:eval(l_options.aspectRatio),preview:l_options.previewSelector,minContainerWidth:parseInt(l_options.minContainerWidth),minContainerHeight:parseInt(l_options.minContainerHeight),minCanvasWidth:parseInt(l_options.minCanvasWidth),minCanvasHeight:parseInt(l_options.minCanvasHeight),minCropBoxWidth:parseInt(l_options.minCropBoxWidth),minCropBoxHeight:parseInt(l_options.minCropBoxHeight)};l_logging&&(apex.debug.trace("apexCropper: Cropper Options :"+options),apex.debug.trace(options),apex.debug.trace("apexCropper: Attribute saveSelector:",l_saveSelector),apex.debug.trace("apexCropper: Attribute croppedImageWidth:",l_croppedImageWidth),apex.debug.trace("apexCropper: Attribute croppedImageHeight:",l_croppedImageHeight),apex.debug.trace("apexCropper: Attribute showSpinner:",l_showSpinner)),$image.cropper(options),$(l_saveSelector).click(function(){if(l_showSpinner)var e=apex.util.showSpinner();var p;l_croppedImageWidth&&l_croppedImageHeight&&!isNaN(options.aspectRatio)?options.aspectRatio===l_croppedImageWidth/l_croppedImageHeight?p=$image.cropper("getCroppedCanvas",{width:l_croppedImageWidth,height:l_croppedImageHeight}):(apex.debug.trace("apexCropper: croppedImageWidth and croppedImageHeight don't respect the ratio format."),p=$image.cropper("getCroppedCanvas")):p=$image.cropper("getCroppedCanvas"),apexCropper.save2Db(l_options.ajaxIdentifier,$image,p.toDataURL(),function(){l_showSpinner&&e.remove()})})}};